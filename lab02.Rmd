---
title: "Lab02"
author: "Nicholas Stout"
date: "September 13, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
choc = read.csv("https://ds202-at-isu.github.io/labs/data/choco.csv")
library(ggplot2)
```
## What is the overall number of chocolate bars rated?
There Are 1852 chocolate bars rated
```{r cars}
dim(choc)
```

## How does the number of ratings depend on the year? Draw a bar chart of the number of reports.

```{r pressure}
count = c()
k = 1
for (i in 2006 : 2017) {
  count[k] = sum(choc$Review.Date == i)
  k = k+1
}

year = c(2006:2017)
y_data = cbind(year, count)

y_data = as.data.frame(y_data)


ggplot(y_data, aes(x = year)) + geom_bar(aes(weight=count))
```

## How are ratings distributed?

The ratings are distrbuted in a somewhat normal distribution, with a median of 3.25. There are are few 1 ratings and a 5 rating as outliers.
```{r}
ggplot(choc, aes(x=Rating)) + geom_histogram(binwidth=0.1)

```

##Do ratings depend on the cocoa percentage of a chocolate bar?
There is not a correlation between the rating and the cocoa percentage
```{r}
ggplot(data=choc, aes(x = Cocoa.Pct, y = Rating)) + geom_point()
```

##How do ratings compare across different company locations?
The maximum and medians are the same, but canada has more higher rated chocolate, while the U.S. has more lower rated chocolate. france has more outliers, towards the lower ratings.
```{r}
top3 <- dplyr::filter(choc, Company.Location %in% c("U.S.A.", "France", "Canada"))
ggplot(data=top3, aes(x = Company.Location, y = Rating)) + geom_boxplot()

```

